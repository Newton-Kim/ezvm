PROGRAM=ezvm
OBJS=ezvm.o
CXXFLAGS=-g -O2 -Wall -std=gnu++11

all: $(PROGRAM)

$(PROGRAM): $(OBJS)
	$(CXX) -o $@ $^

local: ../../lib ../../lib/$(PROGRAM) ../../bin ../../bin/$(PROGRAM)

../../lib/$(PROGRAM): $(PROGRAM)
	cp $< $@

../../bin/$(PROGRAM): $(PROGRAM).in
	cp $< $@
	chmod a+x $@

../../lib ../../bin:
	mkdir $@

install: $(INST_DIR)/bin $(INST_DIR)/bin/$(PROGRAM)

$(INST_DIR)/bin:
	install -d $@

$(INST_DIR)/bin/$(PROGRAM): $(PROGRAM)
	install -s $< $$(dirname "$@")

clean:
	rm -f $(PROGRAM) $(OBJS)

distclean: clean
	rm -f Makefile
